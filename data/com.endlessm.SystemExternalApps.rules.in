polkit.addRule(function(action, subject) {
    if (((action.id == "com.endlessm.SystemExternalApps.build-install") ||
         (action.id == "com.endlessm.SystemExternalApps.remove")) &&
        action.lookup("user") == "@EXT_APPS_HELPER_USER@" &&
	subject.active == true && subject.local == true) {
            if (subject.isInGroup("@PRIVILEGED_GROUP@"))
                return polkit.Result.YES;
            else
                return polkit.Result.AUTH_ADMIN;
    }
});

polkit.addRule(function(action, subject) {
    if ((action.id == "org.freedesktop.Flatpak.runtime-install" ||
         action.id == "org.freedesktop.Flatpak.runtime-uninstall") &&
        subject.user == "@EXT_APPS_HELPER_USER@" && subject.active == true &&
        subject.local == true) {
             return polkit.Result.YES;
    }
});
